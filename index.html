<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RDU Departures by Hour - Feb 26, 2026</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { background: #0f172a; font-family: system-ui, -apple-system, sans-serif; color: #f1f5f9; }
  .wrap { max-width: 920px; margin: 0 auto; padding: 24px; }
  h1 { font-size: 24px; font-weight: 700; margin-bottom: 4px; }
  .sub { color: #94a3b8; font-size: 14px; margin-bottom: 24px; }
  .stats { display: flex; gap: 16px; margin-bottom: 28px; flex-wrap: wrap; }
  .stat { background: #1e293b; border-radius: 10px; padding: 14px 20px; flex: 1 1 140px; min-width: 140px; }
  .stat-label { font-size: 11px; color: #64748b; text-transform: uppercase; letter-spacing: 1px; }
  .stat-val { font-size: 22px; font-weight: 700; margin-top: 4px; }
  .card { background: #1e293b; border-radius: 12px; padding: 24px; margin-bottom: 24px; }
  .legend { display: flex; gap: 20px; margin-bottom: 16px; font-size: 12px; color: #94a3b8; }
  .legend-dot { width: 14px; height: 14px; border-radius: 3px; display: inline-block; vertical-align: middle; margin-right: 6px; }
  .legend-line { width: 20px; height: 3px; border-radius: 2px; display: inline-block; vertical-align: middle; margin-right: 6px; }
  .chart-container { position: relative; width: 100%; height: 370px; }
  canvas { width: 100% !important; }
  h2 { font-size: 16px; font-weight: 600; margin-bottom: 16px; }
  .airline-row { display: flex; align-items: center; gap: 12px; margin-bottom: 10px; }
  .airline-name { width: 100px; font-size: 13px; color: #cbd5e1; text-align: right; }
  .airline-bar-bg { flex: 1; background: #0f172a; border-radius: 6px; height: 24px; overflow: hidden; }
  .airline-bar { height: 100%; border-radius: 6px; display: flex; align-items: center; padding-left: 8px; font-size: 11px; font-weight: 600; color: #fff; min-width: 30px; }
  .tooltip { position: absolute; background: #1e293b; border: 1px solid #334155; border-radius: 8px; padding: 10px 14px; color: #f1f5f9; pointer-events: none; display: none; z-index: 10; font-size: 12px; max-width: 260px; }
  .tooltip-title { font-weight: 700; margin-bottom: 4px; }
  .tooltip-pct { color: #f59e0b; margin-bottom: 4px; }
  .tooltip-list { font-size: 11px; color: #94a3b8; max-height: 180px; overflow-y: auto; }
</style>
</head>
<body>

<div class="wrap">
  <h1>RDU Departures by Hour</h1>
  <p class="sub">Thursday, February 26, 2026 — <span id="totalCount"></span> total non-stop flights</p>

  <div class="stats" id="statsRow"></div>

  <div class="card">
    <div class="legend">
      <div><span class="legend-dot" style="background:#3b82f6"></span>Flights per hour</div>
      <div><span class="legend-line" style="background:#f59e0b"></span>Cumulative % departed</div>
    </div>
    <div class="chart-container">
      <canvas id="chart"></canvas>
      <div class="tooltip" id="tooltip"></div>
    </div>
  </div>

  <div class="card">
    <h2>Flights by Airline</h2>
    <div id="airlines"></div>
  </div>
</div>

<script>
const flights = [
  {t:"05:00",dst:"ORD",fl:"AA3703",al:"American"},{t:"05:03",dst:"CLT",fl:"AA1903",al:"American"},
  {t:"05:15",dst:"ATL",fl:"DL1530",al:"Delta"},{t:"05:25",dst:"MDW",fl:"WN339",al:"Southwest"},
  {t:"05:30",dst:"DTW",fl:"DL1388",al:"Delta"},{t:"05:37",dst:"JFK",fl:"AA4510",al:"American"},
  {t:"05:45",dst:"AUS",fl:"WN1011",al:"Southwest"},
  {t:"06:00",dst:"DCA",fl:"AA4698",al:"American"},{t:"06:00",dst:"LGA",fl:"AA4647",al:"American"},
  {t:"06:00",dst:"DCA",fl:"DL5006",al:"Delta"},{t:"06:00",dst:"EWR",fl:"UA1525",al:"United"},
  {t:"06:00",dst:"MSP",fl:"DL2538",al:"Delta"},{t:"06:00",dst:"LGA",fl:"DL5164",al:"Delta"},
  {t:"06:00",dst:"BOS",fl:"B6984",al:"JetBlue"},{t:"06:05",dst:"BWI",fl:"WN1449",al:"Southwest"},
  {t:"06:06",dst:"MIA",fl:"AA1231",al:"American"},{t:"06:10",dst:"ATL",fl:"F94797",al:"Frontier"},
  {t:"06:15",dst:"IAD",fl:"UA1789",al:"United"},{t:"06:15",dst:"BNA",fl:"WN3299",al:"Southwest"},
  {t:"06:15",dst:"JFK",fl:"B6386",al:"JetBlue"},{t:"06:18",dst:"IAH",fl:"UA1383",al:"United"},
  {t:"06:20",dst:"ATL",fl:"DL1192",al:"Delta"},{t:"06:29",dst:"ORD",fl:"UA2638",al:"United"},
  {t:"06:30",dst:"TPA",fl:"DL1279",al:"Delta"},{t:"06:35",dst:"TPA",fl:"WN676",al:"Southwest"},
  {t:"06:39",dst:"ORD",fl:"AA4408",al:"American"},{t:"06:45",dst:"DFW",fl:"AA802",al:"American"},
  {t:"06:45",dst:"LAS",fl:"DL2027",al:"Delta"},{t:"06:45",dst:"MCO",fl:"WN3312",al:"Southwest"},
  {t:"06:59",dst:"EWR",fl:"DL5120",al:"Delta"},
  {t:"07:00",dst:"CLT",fl:"AA683",al:"American"},{t:"07:00",dst:"PHX",fl:"AA3095",al:"American"},
  {t:"07:00",dst:"FLL",fl:"B62625",al:"JetBlue"},{t:"07:00",dst:"SLC",fl:"DL967",al:"Delta"},
  {t:"07:00",dst:"AUS",fl:"DL4921",al:"Delta"},{t:"07:00",dst:"BOS",fl:"DL1054",al:"Delta"},
  {t:"07:05",dst:"MCO",fl:"DL1337",al:"Delta"},{t:"07:05",dst:"DEN",fl:"WN3308",al:"Southwest"},
  {t:"07:07",dst:"JFK",fl:"DL5239",al:"Delta"},{t:"07:09",dst:"MCI",fl:"DL5230",al:"Delta"},
  {t:"07:36",dst:"SEA",fl:"DL354",al:"Delta"},{t:"07:45",dst:"STL",fl:"WN3317",al:"Southwest"},
  {t:"08:00",dst:"PHL",fl:"AA1559",al:"American"},{t:"08:00",dst:"PIT",fl:"AA4532",al:"American"},
  {t:"08:00",dst:"DEN",fl:"UA2270",al:"United"},{t:"08:08",dst:"MIA",fl:"DL890",al:"Delta"},
  {t:"08:18",dst:"BNA",fl:"DL5114",al:"Delta"},{t:"08:20",dst:"ATL",fl:"DL691",al:"Delta"},
  {t:"08:38",dst:"MIA",fl:"AA1088",al:"American"},{t:"08:40",dst:"BWI",fl:"WN3303",al:"Southwest"},
  {t:"08:42",dst:"PBI",fl:"MX540",al:"Breeze"},{t:"08:45",dst:"SFO",fl:"UA795",al:"United"},
  {t:"08:47",dst:"DFW",fl:"AA1217",al:"American"},{t:"08:47",dst:"BOS",fl:"F93058",al:"Frontier"},
  {t:"08:48",dst:"MHT",fl:"MX744",al:"Breeze"},{t:"08:55",dst:"LGA",fl:"DL5256",al:"Delta"},
  {t:"09:08",dst:"CLT",fl:"AA1906",al:"American"},{t:"09:09",dst:"JAX",fl:"MX408",al:"Breeze"},
  {t:"09:20",dst:"EWR",fl:"UA1753",al:"United"},{t:"09:30",dst:"CUN",fl:"AM585",al:"Aeromexico"},
  {t:"09:30",dst:"YYZ",fl:"AC8837",al:"Air Canada"},{t:"09:35",dst:"BNA",fl:"AA4762",al:"American"},
  {t:"09:38",dst:"BTV",fl:"MX134",al:"Breeze"},{t:"09:40",dst:"ALB",fl:"MX854",al:"Breeze"},
  {t:"09:43",dst:"DAB",fl:"MX754",al:"Breeze"},{t:"09:43",dst:"DTW",fl:"DL2062",al:"Delta"},
  {t:"09:59",dst:"ATL",fl:"DL2647",al:"Delta"},
  {t:"10:00",dst:"ORD",fl:"UA1448",al:"United"},{t:"10:00",dst:"JFK",fl:"DL5294",al:"Delta"},
  {t:"10:04",dst:"BOS",fl:"B6484",al:"JetBlue"},{t:"10:05",dst:"BOS",fl:"DL1022",al:"Delta"},
  {t:"10:26",dst:"DCA",fl:"AA4439",al:"American"},{t:"10:30",dst:"LGA",fl:"AA4459",al:"American"},
  {t:"10:31",dst:"IAD",fl:"UA2163",al:"United"},{t:"10:38",dst:"DFW",fl:"F92343",al:"Frontier"},
  {t:"10:45",dst:"JFK",fl:"AA4788",al:"American"},{t:"10:47",dst:"IAH",fl:"F91741",al:"Frontier"},
  {t:"10:47",dst:"CMH",fl:"MX209",al:"Breeze"},
  {t:"11:00",dst:"IND",fl:"DL4780",al:"Delta"},{t:"11:00",dst:"JFK",fl:"B61486",al:"JetBlue"},
  {t:"11:03",dst:"ATL",fl:"DL1480",al:"Delta"},{t:"11:15",dst:"LAS",fl:"WN1347",al:"Southwest"},
  {t:"11:18",dst:"EWR",fl:"UA1847",al:"United"},{t:"11:20",dst:"PHL",fl:"AA5370",al:"American"},
  {t:"11:20",dst:"MCO",fl:"WN673",al:"Southwest"},{t:"11:24",dst:"CLT",fl:"AA1895",al:"American"},
  {t:"11:32",dst:"MIA",fl:"AA2340",al:"American"},{t:"11:32",dst:"MSP",fl:"DL1578",al:"Delta"},
  {t:"11:36",dst:"DCA",fl:"AA3792",al:"American"},{t:"11:37",dst:"DFW",fl:"AA2683",al:"American"},
  {t:"11:45",dst:"SJU",fl:"B62929",al:"JetBlue"},{t:"11:45",dst:"LGA",fl:"DL1222",al:"Delta"},
  {t:"11:49",dst:"SDF",fl:"MX330",al:"Breeze"},
  {t:"12:05",dst:"BNA",fl:"WN480",al:"Southwest"},{t:"12:10",dst:"BWI",fl:"WN1732",al:"Southwest"},
  {t:"12:13",dst:"FLL",fl:"DL1038",al:"Delta"},{t:"12:25",dst:"EWR",fl:"DL5273",al:"Delta"},
  {t:"12:33",dst:"ATL",fl:"DL2052",al:"Delta"},{t:"12:37",dst:"MCO",fl:"DL1312",al:"Delta"},
  {t:"12:40",dst:"PHX",fl:"WN4848",al:"Southwest"},{t:"12:48",dst:"ORD",fl:"AA3393",al:"American"},
  {t:"12:55",dst:"ATL",fl:"WN3296",al:"Southwest"},
  {t:"13:01",dst:"DTW",fl:"DL2164",al:"Delta"},{t:"13:01",dst:"PHL",fl:"AA5316",al:"American"},
  {t:"13:02",dst:"IAH",fl:"UA6296",al:"United"},{t:"13:05",dst:"LGA",fl:"AA4425",al:"American"},
  {t:"13:05",dst:"HOU",fl:"WN3310",al:"Southwest"},{t:"13:10",dst:"JFK",fl:"AA4765",al:"American"},
  {t:"13:11",dst:"MCO",fl:"F91039",al:"Frontier"},{t:"13:12",dst:"LGA",fl:"DL5274",al:"Delta"},
  {t:"13:13",dst:"CLT",fl:"AA2688",al:"American"},{t:"13:20",dst:"BOS",fl:"DL1033",al:"Delta"},
  {t:"13:25",dst:"YUL",fl:"AC8674",al:"Air Canada"},{t:"13:26",dst:"ORD",fl:"UA1920",al:"United"},
  {t:"13:37",dst:"DCA",fl:"AA4048",al:"American"},{t:"13:57",dst:"HVN",fl:"XP676",al:"Avelo"},
  {t:"14:08",dst:"RSW",fl:"MX745",al:"Breeze"},{t:"14:12",dst:"JFK",fl:"DL5009",al:"Delta"},
  {t:"14:20",dst:"BDL",fl:"MX541",al:"Breeze"},{t:"14:33",dst:"PVD",fl:"MX755",al:"Breeze"},
  {t:"14:39",dst:"MCO",fl:"MX855",al:"Breeze"},{t:"14:40",dst:"FLL",fl:"WN1433",al:"Southwest"},
  {t:"14:40",dst:"MIA",fl:"F93321",al:"Frontier"},{t:"14:41",dst:"LGA",fl:"AA4560",al:"American"},
  {t:"14:51",dst:"EWR",fl:"UA2856",al:"United"},{t:"14:54",dst:"CLT",fl:"AA1897",al:"American"},
  {t:"14:55",dst:"DAL",fl:"WN3307",al:"Southwest"},{t:"14:57",dst:"CVG",fl:"DL4911",al:"Delta"},
  {t:"15:01",dst:"MEX",fl:"AM431",al:"Aeromexico"},{t:"15:02",dst:"DCA",fl:"DL5310",al:"Delta"},
  {t:"15:03",dst:"IAD",fl:"UA2463",al:"United"},{t:"15:08",dst:"FLL",fl:"NK1761",al:"Spirit"},
  {t:"15:15",dst:"YYZ",fl:"AC8839",al:"Air Canada"},{t:"15:18",dst:"ATL",fl:"DL2026",al:"Delta"},
  {t:"15:22",dst:"TPA",fl:"MX135",al:"Breeze"},{t:"15:27",dst:"PHL",fl:"F92072",al:"Frontier"},
  {t:"15:30",dst:"BWI",fl:"WN331",al:"Southwest"},{t:"15:35",dst:"PSM",fl:"MX2854",al:"Breeze"},
  {t:"15:37",dst:"LGA",fl:"DL5818",al:"Delta"},{t:"15:46",dst:"JFK",fl:"B62486",al:"JetBlue"},
  {t:"15:47",dst:"DFW",fl:"AA2693",al:"American"},{t:"15:51",dst:"BNA",fl:"AA4685",al:"American"},
  {t:"16:04",dst:"MCO",fl:"F91111",al:"Frontier"},{t:"16:06",dst:"DEN",fl:"UA2288",al:"United"},
  {t:"16:10",dst:"AUS",fl:"DL4967",al:"Delta"},{t:"16:15",dst:"FRA",fl:"LH409",al:"Lufthansa"},
  {t:"16:20",dst:"CLT",fl:"AA2704",al:"American"},{t:"16:24",dst:"PHL",fl:"AA5476",al:"American"},
  {t:"16:29",dst:"ORD",fl:"AA4652",al:"American"},{t:"16:29",dst:"MSY",fl:"MX331",al:"Breeze"},
  {t:"16:47",dst:"IAH",fl:"UA2407",al:"United"},{t:"16:50",dst:"ATL",fl:"DL1550",al:"Delta"},
  {t:"16:50",dst:"LAX",fl:"DL462",al:"Delta"},{t:"16:55",dst:"DEN",fl:"F92225",al:"Frontier"},
  {t:"17:00",dst:"DTW",fl:"DL1407",al:"Delta"},{t:"17:14",dst:"ORD",fl:"UA1625",al:"United"},
  {t:"17:16",dst:"BNA",fl:"DL5152",al:"Delta"},{t:"17:20",dst:"AUS",fl:"WN1975",al:"Southwest"},
  {t:"17:20",dst:"PHX",fl:"AA795",al:"American"},{t:"17:27",dst:"LGA",fl:"AA4497",al:"American"},
  {t:"17:28",dst:"DCA",fl:"AA4624",al:"American"},{t:"17:41",dst:"ORD",fl:"AA3597",al:"American"},
  {t:"17:54",dst:"ATL",fl:"DL1235",al:"Delta"},{t:"17:57",dst:"LGA",fl:"DL5227",al:"Delta"},
  {t:"18:00",dst:"TPA",fl:"WN3320",al:"Southwest"},{t:"18:01",dst:"EWR",fl:"DL5222",al:"Delta"},
  {t:"18:06",dst:"TPA",fl:"DL2046",al:"Delta"},{t:"18:08",dst:"EWR",fl:"NK257",al:"Spirit"},
  {t:"18:11",dst:"MCO",fl:"DL1319",al:"Delta"},{t:"18:13",dst:"MIA",fl:"AA3045",al:"American"},
  {t:"18:20",dst:"DEN",fl:"WN4227",al:"Southwest"},{t:"18:27",dst:"SFO",fl:"UA1769",al:"United"},
  {t:"18:29",dst:"ORD",fl:"AA4402",al:"American"},{t:"18:33",dst:"CLT",fl:"AA1894",al:"American"},
  {t:"18:36",dst:"LAX",fl:"AA2308",al:"American"},{t:"18:40",dst:"JFK",fl:"AA4804",al:"American"},
  {t:"18:45",dst:"BOS",fl:"B62184",al:"JetBlue"},{t:"18:47",dst:"EWR",fl:"UA3643",al:"United"},
  {t:"18:51",dst:"SEA",fl:"AS572",al:"Alaska"},{t:"18:53",dst:"MSP",fl:"DL2519",al:"Delta"},
  {t:"18:54",dst:"PHL",fl:"AA4411",al:"American"},{t:"18:55",dst:"ATL",fl:"F91669",al:"Frontier"},
  {t:"18:59",dst:"JFK",fl:"DL5219",al:"Delta"},
  {t:"19:00",dst:"MCO",fl:"WN1001",al:"Southwest"},{t:"19:09",dst:"TPA",fl:"F93373",al:"Frontier"},
  {t:"19:18",dst:"DFW",fl:"AA771",al:"American"},{t:"19:30",dst:"PIT",fl:"AA4742",al:"American"},
  {t:"19:35",dst:"BOS",fl:"DL2393",al:"Delta"},{t:"19:37",dst:"DCA",fl:"DL5198",al:"Delta"},
  {t:"19:40",dst:"LGA",fl:"AA4704",al:"American"},{t:"19:43",dst:"MIA",fl:"AA1891",al:"American"},
  {t:"19:49",dst:"ATL",fl:"DL1097",al:"Delta"},{t:"19:52",dst:"FLL",fl:"B6725",al:"JetBlue"},
  {t:"19:55",dst:"LGA",fl:"DL5101",al:"Delta"},{t:"19:55",dst:"MDW",fl:"WN3316",al:"Southwest"},
  {t:"20:00",dst:"IAD",fl:"UA2091",al:"United"},{t:"20:00",dst:"BWI",fl:"WN4361",al:"Southwest"},
  {t:"20:04",dst:"CAK",fl:"MX409",al:"Breeze"},{t:"20:10",dst:"STL",fl:"WN523",al:"Southwest"},
  {t:"20:19",dst:"CLT",fl:"AA1904",al:"American"},{t:"20:20",dst:"SJU",fl:"F91226",al:"Frontier"},
  {t:"20:35",dst:"LHR",fl:"AA174",al:"American"},{t:"20:45",dst:"BNA",fl:"WN4966",al:"Southwest"},
  {t:"21:05",dst:"MCO",fl:"MX2855",al:"Breeze"},{t:"21:07",dst:"DCA",fl:"AA5577",al:"American"},
  {t:"21:59",dst:"MCO",fl:"F91233",al:"Frontier"},
  {t:"22:18",dst:"PHL",fl:"F91518",al:"Frontier"},{t:"22:20",dst:"BNA",fl:"AA4646",al:"American"},
];

// Process data
const hourCounts = {};
for (let h = 5; h <= 22; h++) hourCounts[h] = 0;
flights.forEach(f => { hourCounts[parseInt(f.t.split(":")[0])]++; });

let cum = 0;
const total = flights.length;
const hours = [];
for (let h = 5; h <= 22; h++) {
  cum += hourCounts[h];
  const lbl = h < 12 ? h + "am" : h === 12 ? "12pm" : (h - 12) + "pm";
  hours.push({ h, count: hourCounts[h], cumPct: Math.round((cum / total) * 1000) / 10, label: lbl });
}

const peak = hours.reduce((a, b) => a.count > b.count ? a : b);
const airlineCounts = {};
flights.forEach(f => { airlineCounts[f.al] = (airlineCounts[f.al] || 0) + 1; });
const airlineData = Object.entries(airlineCounts).sort((a, b) => b[1] - a[1]);
const destinations = new Set(flights.map(f => f.dst)).size;

// Render stats
document.getElementById("totalCount").textContent = total;
const statsRow = document.getElementById("statsRow");
[
  ["Total Flights", total],
  ["Peak Hour", peak.label + " (" + peak.count + ")"],
  ["Airlines", Object.keys(airlineCounts).length],
  ["Destinations", destinations]
].forEach(([label, val]) => {
  const d = document.createElement("div");
  d.className = "stat";
  d.innerHTML = '<div class="stat-label">' + label + '</div><div class="stat-val">' + val + '</div>';
  statsRow.appendChild(d);
});

// Render airline bars
const airlinesDiv = document.getElementById("airlines");
const maxAl = airlineData[0][1];
airlineData.forEach(([name, count], i) => {
  const row = document.createElement("div");
  row.className = "airline-row";
  row.innerHTML = '<div class="airline-name">' + name + '</div>' +
    '<div class="airline-bar-bg"><div class="airline-bar" style="width:' +
    (count / maxAl * 100) + '%;background:' + (i === 0 ? "#f59e0b" : "#3b82f6") +
    '">' + count + '</div></div>';
  airlinesDiv.appendChild(row);
});

// Draw chart on canvas
const canvas = document.getElementById("chart");
const tooltip = document.getElementById("tooltip");
const dpr = window.devicePixelRatio || 1;

function draw() {
  const rect = canvas.parentElement.getBoundingClientRect();
  const W = rect.width;
  const H = rect.height;
  canvas.width = W * dpr;
  canvas.height = H * dpr;
  canvas.style.width = W + "px";
  canvas.style.height = H + "px";
  const ctx = canvas.getContext("2d");
  ctx.scale(dpr, dpr);

  const padL = 45, padR = 55, padT = 20, padB = 40;
  const cw = W - padL - padR;
  const ch = H - padT - padB;
  const n = hours.length;
  const barW = (cw / n) * 0.65;
  const gap = cw / n;
  const maxCount = Math.ceil(peak.count / 5) * 5;

  // Grid lines
  ctx.strokeStyle = "#334155";
  ctx.lineWidth = 0.5;
  ctx.setLineDash([4, 4]);
  for (let i = 0; i <= 5; i++) {
    const y = padT + ch - (i / 5) * ch;
    ctx.beginPath(); ctx.moveTo(padL, y); ctx.lineTo(W - padR, y); ctx.stroke();
  }
  ctx.setLineDash([]);

  // Left Y axis labels (count)
  ctx.fillStyle = "#94a3b8";
  ctx.font = "11px system-ui";
  ctx.textAlign = "right";
  for (let i = 0; i <= 5; i++) {
    const val = Math.round((i / 5) * maxCount);
    const y = padT + ch - (i / 5) * ch;
    ctx.fillText(val, padL - 8, y + 4);
  }

  // Right Y axis labels (%)
  ctx.textAlign = "left";
  ctx.fillStyle = "#f59e0b";
  for (let i = 0; i <= 5; i++) {
    const val = i * 20;
    const y = padT + ch - (i / 5) * ch;
    ctx.fillText(val + "%", W - padR + 8, y + 4);
  }

  // X axis labels
  ctx.textAlign = "center";
  ctx.fillStyle = "#94a3b8";
  hours.forEach((d, i) => {
    const x = padL + i * gap + gap / 2;
    ctx.fillText(d.label, x, H - padB + 20);
  });

  // Store bar rects for hover
  const barRects = [];

  // Draw bars
  hours.forEach((d, i) => {
    const x = padL + i * gap + (gap - barW) / 2;
    const barH = (d.count / maxCount) * ch;
    const y = padT + ch - barH;
    const color = d.h === peak.h ? "#f59e0b" : "#3b82f6";

    // Rounded rect
    const r = Math.min(6, barW / 2);
    ctx.fillStyle = color;
    ctx.beginPath();
    ctx.moveTo(x + r, y);
    ctx.lineTo(x + barW - r, y);
    ctx.quadraticCurveTo(x + barW, y, x + barW, y + r);
    ctx.lineTo(x + barW, y + barH);
    ctx.lineTo(x, y + barH);
    ctx.lineTo(x, y + r);
    ctx.quadraticCurveTo(x, y, x + r, y);
    ctx.fill();

    barRects.push({ x, y, w: barW, h: barH, idx: i });
  });

  // Draw cumulative line
  ctx.strokeStyle = "#f59e0b";
  ctx.lineWidth = 2.5;
  ctx.beginPath();
  const linePoints = [];
  hours.forEach((d, i) => {
    const x = padL + i * gap + gap / 2;
    const y = padT + ch - (d.cumPct / 100) * ch;
    linePoints.push({ x, y });
    if (i === 0) ctx.moveTo(x, y); else ctx.lineTo(x, y);
  });
  ctx.stroke();

  // Draw dots on line
  linePoints.forEach(p => {
    ctx.fillStyle = "#f59e0b";
    ctx.beginPath();
    ctx.arc(p.x, p.y, 3, 0, Math.PI * 2);
    ctx.fill();
  });

  // Hover handling
  canvas.onmousemove = function(e) {
    const r = canvas.getBoundingClientRect();
    const mx = e.clientX - r.left;
    const my = e.clientY - r.top;

    let hit = -1;
    for (let i = 0; i < hours.length; i++) {
      const bx = padL + i * gap;
      if (mx >= bx && mx < bx + gap) { hit = i; break; }
    }

    if (hit >= 0) {
      const d = hours[hit];
      const inHour = flights.filter(f => parseInt(f.t.split(":")[0]) === d.h);
      let html = '<div class="tooltip-title">' + d.label + " — " + d.count + " flights</div>";
      html += '<div class="tooltip-pct">' + d.cumPct + "% departed by end of hour</div>";
      html += '<div class="tooltip-list">';
      inHour.forEach(f => { html += f.t + " → " + f.dst + " (" + f.fl + ")<br>"; });
      html += "</div>";
      tooltip.innerHTML = html;
      tooltip.style.display = "block";

      let tx = mx + 16;
      let ty = my - 10;
      if (tx + 260 > W) tx = mx - 270;
      if (ty < 0) ty = 10;
      tooltip.style.left = tx + "px";
      tooltip.style.top = ty + "px";
    } else {
      tooltip.style.display = "none";
    }
  };

  canvas.onmouseleave = function() {
    tooltip.style.display = "none";
  };
}

draw();
window.addEventListener("resize", draw);
</script>
</body>
</html>